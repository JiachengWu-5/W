---
import { getCollection } from "astro:content";
import PostPage from "@components/PostPage.astro";
import I18nKey from "@i18n/i18nKey";
import { i18n } from "@i18n/translation";
import MainGridLayout from "../layouts/MainGridLayout.astro";

const title = i18n(I18nKey.recommend);

const candidates = [title, "Recommend", "recommend", "å®‰åˆ©"];

const allPosts = await getCollection("posts", ({ data }) => {
	return import.meta.env.PROD ? data.draft !== true : true;
});

const filtered = allPosts
	.filter((p) => {
		const c = p.data.category ? String(p.data.category).trim() : "";
		return candidates.includes(c) || candidates.includes(c.toLowerCase());
	})
	.sort((a, b) =>
		new Date(a.data.published) > new Date(b.data.published) ? -1 : 1,
	);
---

<MainGridLayout title={title}>
    <div class="w-full">
        <h1 class="text-3xl font-bold mb-4">{title}</h1>
        <PostPage page={{ data: filtered }}></PostPage>
    </div>
</MainGridLayout>
